{% extends "base_site.html" %}

<!-- benötigte Variablen: spielzeiten, spieltipp_previous, spieltipp_next -->
{% load i18n  %}
{% block breadcrumbs %}

    <div class="breadcrumbs">
    	<div style="float:left">
		    <a href="{% url BuLiTippApp.views.index %}">{% trans 'Home' %}</a>
		    {% if title %} &rsaquo; {{ title }}{% endif %}
		    {% if aktuelle_spielzeit.id %}
			    -&rsaquo;
			    <a href="{% url BuLiTippApp.views.index aktuelle_spielzeit.id %}">{{ aktuelle_spielzeit.bezeichner }}</a>
		    {% endif %}
	    </div>
    	<div style="float:right;">
    		{% include "navigation.html" %}
    	</div>
    	<div style="clear:both"></div>
    </div>

{% endblock %}


{% block content %}
<div class="jumbotron">

<h1>Bundesliga-Tipp</h1>
Ideen für weitere Inhalte oder Änderungen/Kritik/Gestaltung gerne an: <a href="mailto:info@tippbuli.de">info@TippBuLi.de</a>

</div>
<h2>Neueste Mitteilungen</h2>
<a class="btn btn-info active" role="button" href="{% url BuLiTippApp.views.news %}">alle Mitteilungen</a>

<div class="list-group">
{% for news_ in news %}
  <a href="#" class="list-group-item ">
    <h4 class="list-group-item-heading">von {{ news_.author.username }} am {{news_.datum}}</h4>
    <p class="list-group-item-text">{{news_.text|safe}}
	</p>
  </a>
{% endfor %}
</div>

<!-- Wenn mehrere Saisons vorhanden -> Saison ausählen -->
{% if user.is_authenticated %}
    {% if spielzeiten|length > 1 %}
	    <p>Bitte Spielzeit auswählen <span class="badge">{{spielzeiten|length}}</span></p>
        <div class="btn-group btn-group-justified">
		    {% for spielzeit in spielzeiten %}
			    <a class="btn btn-success" role="button"href="{% url BuLiTippApp.views.start spielzeit.id %}">{{spielzeit.bezeichner}} auswählen</a>
		    {% endfor %}
		    </div>
    {% endif %}
{% endif %}

{% if spielzeiten|length == 0 %}
	{% if spieltipp_previous %}

		<div>
			<div style="float:left">
				<h2>Die Ergebnisse des letzten Spieltages:</h2>
				{% with spieltag=spieltipp_previous.0.0.spieltag _no_navigation_="true" spieltipp=spieltipp_previous kommentare=spieltipp_previous.0.0.spieltag.kommentar_set.all %}
				Hier die Übersicht des {{spieltag.nummer}}. Spieltages!

				{% include "spieltag/inline.html" %}
			</div>
			{% if not spieltag.is_tippable %}
			        {% with userpunkteplatz=aktuelle_spielzeit.userpunkteplatz spielzeit=aktuelle_spielzeit %}
			                <div style="float:right; padding:15px;">
					<b>Saisonverlauf:</b>
				                {% include "bestenliste/inline.html" %}<!-- maybe _switchable ? -->
			                </div>
			        {% endwith %}
			{% endif %}
			<div style="clear:both"></div>
		</div>


		{% include "kommentar/detail.html" %}

		{% endwith %}

	{% endif %}

	{% if spieltipp_next %}
		<h2>Hier der nächste Spieltag!</h2>
		{% with spieltag=spieltipp_next.0.0.spieltag no_navigation="true" spieltipp=spieltipp_next  %}
		Tippen noch möglich bis zum <strong>{{spieltag.datum}}</strong>!
		{% include "spieltag/inline.html" %}

		{% with kommentare=spieltag.kommentar_set.all %}
			{% include "kommentar/detail.html" %}
		{% endwith %}

		{% endwith %}
	{% endif %}
{% endif %}

{% endblock %}
